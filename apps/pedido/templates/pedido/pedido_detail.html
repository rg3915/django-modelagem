{% extends 'base.html' %}

{% block title %}Pedido #{{ pedido.id }} - Detalhes{% endblock %}

{% block content %}
<article>
    <header>
        <h1>Pedido #{{ pedido.id }}</h1>
        <div style="display: flex; gap: 1rem;">
            <a href="{% url 'pedido:pedido_list' %}" role="button" class="outline">Voltar</a>
        </div>
    </header>

    <table>
        <tbody>
            <tr>
                <th scope="row">Cliente</th>
                <td>{{ pedido.cliente.nome }}</td>
            </tr>
            <tr>
                <th scope="row">Status</th>
                <td>{{ pedido.get_status_display }}</td>
            </tr>
            <tr>
                <th scope="row">Data</th>
                <td>{{ pedido.data|date:"d/m/Y"|default:"-" }}</td>
            </tr>
            <tr>
                <th scope="row">UUID</th>
                <td><code>{{ pedido.uuid }}</code></td>
            </tr>
            <tr>
                <th scope="row">Ativo</th>
                <td>
                    {% if pedido.ativo %}
                        <span style="color: var(--pico-primary);">Ativo</span>
                    {% else %}
                        <span style="color: var(--pico-del-color);">Inativo</span>
                    {% endif %}
                </td>
            </tr>
            <tr>
                <th scope="row">Criado em</th>
                <td>{{ pedido.criado_em|date:"d/m/Y H:i" }}</td>
            </tr>
            <tr>
                <th scope="row">Modificado em</th>
                <td>{{ pedido.modificado_em|date:"d/m/Y H:i" }}</td>
            </tr>
        </tbody>
    </table>

    <h2>Itens do Pedido</h2>
    <table role="grid">
        <thead>
            <tr>
                <th>Produto</th>
                <th>Quantidade</th>
                <th>Pre√ßo Unit.</th>
                <th>Subtotal</th>
            </tr>
        </thead>
        <tbody>
            {% for item in pedido.itens.all %}
            <tr>
                <td>{{ item.produto.titulo }}</td>
                <td>{{ item.quantidade }}</td>
                <td>R$ {{ item.preco }}</td>
                <td>R$ {{ item.get_subtotal|floatformat:2 }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4" style="text-align: center;">Nenhum item no pedido.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    {% if pedido.itens.all %}
    <div style="text-align: right; margin-top: 1rem;">
        <strong>Total Geral: R$ {{ pedido.get_total|floatformat:2 }}</strong>
    </div>
    {% endif %}
</article>
{% endblock %}
